<div class="max-w-lg mx-auto mt-8 p-4 bg-white dark:bg-gray-800 rounded shadow">
  <h2 class="text-2xl font-bold mb-4">Todo List</h2>
  <form (ngSubmit)="addTodo()" class="flex gap-2 mb-4">
    <input
      [(ngModel)]="newTodo"
      name="todo"
      class="flex-1 p-2 border rounded"
      placeholder="輸入待辦事項"
      required
    />
    <button type="submit" class="px-4 py-2 bg-blue-500 text-white rounded">
      新增
    </button>
  </form>
  <ul>
    <li
      *ngFor="let todo of (todos$ | async) ?? []"
      class="flex items-center gap-2 mb-2"
    >
      <input
        type="checkbox"
        [checked]="todo.completed"
        (change)="toggleComplete(todo)"
      />
      <span
        [class.line-through]="todo.completed"
        [class.text-gray-400]="todo.completed"
        >{{ todo.text }}</span
      >
      <button (click)="editTodo(todo)" class="text-xs text-yellow-600">
        編輯
      </button>
      <button (click)="deleteTodo(todo.id)" class="text-xs text-red-600">
        刪除
      </button>
    </li>
  </ul>
  <div *ngIf="editingTodo">
    <input [(ngModel)]="editingText" class="p-2 border rounded" />
    <button
      (click)="updateTodo()"
      class="px-2 py-1 bg-green-500 text-white rounded"
    >
      儲存
    </button>
    <button
      (click)="cancelEdit()"
      class="px-2 py-1 bg-gray-400 text-white rounded"
    >
      取消
    </button>
  </div>
</div>
